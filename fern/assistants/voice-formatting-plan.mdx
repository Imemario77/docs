---
title: Voice formatting plan
subtitle: Format LLM output for natural-sounding speech
slug: assistants/voice-formatting-plan
---

## Overview

Voice formatting automatically transforms raw text from your language model (LLM) into a format that sounds natural when spoken by a text-to-speech (TTS) provider. This process—called **Voice Input Formatted**—is enabled by default for all assistants.

Formatting helps with things like:

- Expanding numbers and currency (e.g., `$42.50` → "forty two dollars and fifty cents")
- Expanding abbreviations (e.g., `ST` → "STREET")
- Spacing out phone numbers (e.g., `123-456-7890` → "1 2 3 4 5 6 7 8 9 0")

You can turn off formatting if you want the TTS to read the raw LLM output.

## How voice input formatting works

When enabled, the formatter runs a series of transformations on your text, each handled by a specific function. Here's the order and what each function does:

<Steps>

  <Step title="removeAngleBracketContent">
    Removes anything in `<...>`, except for `<break>`, `<spell>`, or double angle brackets `<< >>`.

    **Example:**
    ```
    Hello <tag> world
    **Wanted** to say *hi*
    ...
    ```
    Becomes:
    ```
    Hello  world
    **Wanted** to say *hi*
    ...
    ```
  </Step>

  <Step title="removeMarkdownSymbols">
    Removes markdown characters like `_`, `` ` ``, and `~`. Some versions also remove double asterisks, but that might happen in the next step.

    **Example:**
    ```
    **Wanted** to say *hi*
    ```
    If only `_`, backticks, and tildes are removed, asterisks remain for now.
  </Step>

  <Step title="removePhrasesInAsterisks">
    Removes text wrapped in single or double asterisks.

    **Example:**
    ```
    **Wanted** to say *hi*
    ```
    Becomes:
    ```
     to say
    ```
  </Step>

  <Step title="replaceNewLinesWithPeriods">
    Converts line breaks to periods for smoother speech.

    **Example:**
    ```
    Hello  world\n to say\nWe have NASA and .NET here,\ncall me at 123-456-7890,\nprice: $42.50\nand the date is 2023 05 10\nand time is 14:00\nDistance is 5km\nWe might see 9999\nthe address is 320 ST 21 RD\nmy email is JOHN.DOE@example.COM
    ```
    Becomes:
    ```
    Hello  world .  to say . We have NASA and .NET here, call me at 123-456-7890, price: $42.50 and the date is 2023 05 10 and time is 14:00 Distance is 5km We might see 9999 the address is 320 ST 21 RD my email is JOHN.DOE@example.COM
    ```
  </Step>

  <Step title="replaceColonsWithPeriods">
    Replaces `:` with `.` for better phrasing.

    **Example:**
    ```
    price: $42.50
    ```
    Becomes:
    ```
    price. $42.50
    ```
  </Step>

  <Step title="formatAcronyms">
    Converts known acronyms to lowercase or spaces out unknown all-caps words. If it's all-caps but not recognized, it might get spaced letters. If it has vowels, it's left alone.

    **Example:**
    - `NASA` → `nasa`
    - `.NET` → `.net`
  </Step>

  <Step title="formatDollarAmounts">
    Expands currency to words.

    **Example:**
    - `$42.50` → "forty two dollars and fifty cents"
  </Step>

  <Step title="formatEmails">
    Replaces `@` with "at" and `.` with "dot" in email addresses.

    **Example:**
    - `JOHN.DOE@example.COM` → `JOHN dot DOE at example dot COM`
  </Step>

  <Step title="formatDates">
    Converts date strings to spoken dates.

    **Example:**
    - `2023 05 10` → "Wednesday, May 10, 2023"
  </Step>

  <Step title="formatTimes">
    Expands time strings for clarity.

    **Example:**
    - `14:00` → `14`
  </Step>

  <Step title="formatDistances, formatUnits, formatPercentages, formatPhoneNumbers">
    - `5km` → "5 kilometers"
    - `43 lb` → "forty three pounds"
    - `50%` → "50 percent"
    - `123-456-7890` → "1 2 3 4 5 6 7 8 9 0"
  </Step>

  <Step title="formatNumbers">
    - Years below the current year are read as digits (e.g., `2023`)
    - Large numbers above a cutoff are read as digits
    - Negative numbers: `-9` → "minus nine"
    - Decimals: `2.5` → "two point five"
  </Step>

  <Step title="Applying Replacements">
    Runs user-defined replacements last, such as expanding street abbreviations.

    **Example:**
    - `320 ST 21 RD` → `320 STREET 21 ROAD`
  </Step>

</Steps>

---

## Customizing the formatting plan

You can control some aspects of formatting:

### Enabled
Formatting is on by default. To disable, set:
```js
voice.chunkPlan.formatPlan.enabled = false
```

### Number-to-digits cutoff
Controls when numbers are read as digits instead of words.
- **Default:** `2025` (current year)
- Example: With a cutoff of `2025`, numbers above this are read as digits.
- To spell out larger numbers, set the cutoff higher (e.g., `300000`).

### Replacements
Add exact or regex-based substitutions to customize output.
- **Example 1:** Replace `hello` with `hi`:
  ```js
  { type: 'exact', key: 'hello', value: 'hi' }
  ```
- **Example 2:** Replace words matching a pattern:
  ```js
  { type: 'regex', regex: '\b[a-zA-Z]{5}\b', value: 'hi' }
  ```

<Note>
Currently, only replacements and the number-to-digits cutoff are customizable. Other options are not exposed.
</Note>

---

## Turning formatting off

To disable all formatting and use raw LLM output, set either of these to `false`:

```js
voice.chunkPlan.enabled = false
// or
voice.chunkPlan.formatPlan.enabled = false
```

---

## Summary

- Voice input formatting improves clarity and naturalness for TTS.
- Each transformation step targets a specific pattern for better speech output.
- You can customize or disable formatting as needed.
